# Обзор типов языковых промптов в SurfSense

## Введение

Данная документация описывает все типы языковых промптов, используемых в системе SurfSense для взаимодействия с языковыми моделями (LLM). Каждый тип промпта играет уникальную роль в цепочке обработки и преобразования данных.

## Категории промптов

### 1. Системные промпты (System Prompts)

Определяют поведение и личность языковой модели в рамках конкретной задачи.

- **[Q&A с цитированием](system-prompts/qna-with-citations.md)** - Ответы на вопросы с явным указанием источников
- **[Q&A без документов](system-prompts/qna-no-documents.md)** - Ответы на основе общих знаний модели

### 2. Задачно-ориентированные промпты (Task Prompts)

Промпты для выполнения специфических задач обработки данных.

- **[Суммаризация документов](task-prompts/document-summarization.md)** - Создание структурированных резюме документов
- **[Генерация дополнительных вопросов](task-prompts/further-questions.md)** - Создание контекстуальных follow-up вопросов
- **[Переформулировка запросов](task-prompts/query-reformulation.md)** - Улучшение пользовательских запросов

### 3. Креативные промпты (Creative Prompts)

Промпты для генерации креативного контента.

- **[Генерация подкастов](creative-prompts/podcast-generation.md)** - Преобразование текста в диалоговый формат подкаста

### 4. Промпты для поиска (Retrieval Prompts)

Промпты для оптимизации поиска и ранжирования документов.

- **[Переранжирование документов](retrieval-prompts/document-reranking.md)** - Определение релевантности документов

### 5. Контекстные промпты (Context Prompts)

Промпты для интеграции и обогащения контекста.

- **[Интеграция истории чата](context-prompts/chat-history-integration.md)** - Поддержка непрерывности диалога

## Архитектура взаимодействия

```
┌─────────────────────────────────────────────────────────────┐
│                    Пользовательский запрос                   │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│              Переформулировка запроса (если нужно)           │
│                  Query Reformulation Prompt                  │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                  Гибридный поиск документов                  │
│              (Vector + Keyword + Metadata Search)            │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│               Переранжирование документов                    │
│              Document Reranking Prompt                       │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                Интеграция контекста и истории                │
│            Chat History Integration Pattern                  │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                  Генерация ответа с цитатами                 │
│                  Q&A with Citations Prompt                   │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│              Генерация дополнительных вопросов               │
│                Further Questions Prompt                      │
└─────────────────────────────────────────────────────────────┘
```

## Стек технологий

### Основные библиотеки для работы с LLM:

- **LiteLLM** (v1.77.5+) - Унифицированный интерфейс к 25+ провайдерам LLM
- **LangChain** (v0.3+) - Фреймворк для построения приложений с LLM
- **LangGraph** (v0.3.29+) - Оркестрация агентов и управление состоянием

### Поддерживаемые провайдеры:

- OpenAI (GPT-4o, O1, O3)
- Anthropic (Claude 3.5/4)
- Google (Gemini 2.5)
- DeepSeek, xAI (Grok), Azure, AWS Bedrock
- Groq, Cerebras, Together AI (быстрый инференс)
- Ollama (локальные модели)

Подробнее: [Библиотеки и инструменты](libraries-and-tools.md)

## Цепочки преобразований

Все промпты организованы в логические цепочки обработки данных, построенные на базе LangGraph. Каждая цепочка представляет собой направленный граф состояний (StateGraph), где узлы выполняют преобразования, а рёбра определяют потоки данных.

Подробнее: [Цепочки преобразований](transformation-chains.md)

## Принципы проектирования промптов

1. **Модульность** - Каждый промпт решает одну задачу
2. **Композируемость** - Промпты легко объединяются в цепочки
3. **Многоязычность** - Поддержка языковых инструкций
4. **Контекстуальность** - Использование XML-разметки для структурирования контекста
5. **Токен-эффективность** - Динамическое усечение для оптимизации контекстного окна
6. **Стриминг** - Все промпты поддерживают потоковую генерацию ответов

## Структура документации

Каждый файл промпта содержит:

- **Описание** - Назначение и область применения
- **Текст промпта** - Полный шаблон промпта
- **Параметры** - Динамические переменные
- **Роль в цепочке** - Позиция в pipeline обработки
- **Связи** - Входящие и исходящие преобразования
- **Используемые инструменты** - Библиотеки и зависимости
- **Примеры использования** - Практические кейсы
- **Конфигурация LLM** - Рекомендуемые модели и параметры

## Метрики качества

Для каждого типа промпта определены критерии оценки:

- **Точность** (Accuracy) - Корректность генерируемого контента
- **Релевантность** (Relevance) - Соответствие запросу пользователя
- **Цитирование** (Citation Quality) - Корректность ссылок на источники
- **Латентность** (Latency) - Время генерации ответа
- **Использование токенов** (Token Efficiency) - Оптимизация контекста

## Навигация

- [Библиотеки и инструменты](libraries-and-tools.md) - Полное описание используемых технологий
- [Цепочки преобразований](transformation-chains.md) - Архитектура pipeline обработки
- [System Prompts](system-prompts/) - Системные промпты
- [Task Prompts](task-prompts/) - Задачно-ориентированные промпты
- [Creative Prompts](creative-prompts/) - Креативные промпты
- [Retrieval Prompts](retrieval-prompts/) - Промпты для поиска
- [Context Prompts](context-prompts/) - Контекстные промпты
